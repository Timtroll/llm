# Скрипт управления LLM

Этот Bash-скрипт позволяет запустить локально **LLM** и интерфейс к нему. Он запускает 2 контейнера:

- первый контейнер запускает LLM и backend к вебинтерфейсу. backend доступен по адресу http://localhost:5555
- второй контейнер запускает frontend доступен по адресу http://localhost:5000

## Требования
- **Docker**: Убедитесь, что Docker установлен и запущен.
- **Docker Compose**: Необходим для управления многоконтейнерными приложениями Docker.
- **wget**: Используется для загрузки файлов моделей.

## Установка
1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/Timtroll/llm.git
   cd <директория-репозитория>
   ```
2. **Укажите рабочую директорию** (опционально):
   - По умолчанию: `<текущая директория>` где расположен скрипт

## Использование
Запустите скрипт с командами:
```bash
./llm.sh [опции]
```

### Опции
- запуск без опций приведет к установке и запуску контейнеров (скрипт проверяет наличией *.gguf моделей в текущей директории, и если нет указанных в скрипте - скачивает их).
- `--help`: Показать справку и выйти.
- `--rebuild`: Пересобрать и запустить контейнеры.
- `--stop`: Остановить запущенные контейнеры.

### Примеры
- Запуск или перезапуск контейнеров:
  ```bash
  ./llm.sh
  ```
- Пересборка и запуск контейнеров:
  ```bash
  ./llm.sh --rebuild
  ```
- Остановка контейнеров:
  ```bash
  ./llm.sh --stop
  ```
- Показать справку:
  ```bash
  ./llm.sh --help
  ```

## Возможности
- **Загрузка моделей**: Автоматически загружает необходимые модели ML, если их нет (можете изменить адреса скачиваемых моделей на другие модели):
  - `llama-7b.Q4_0.gguf`
  - `model-q4_K.gguf`
- **Управление контейнерами**: Запускает, останавливает или пересобирает контейнеры Docker на основе инструкций в `docker-compose.yml`.
- **API и фронтенд**:
  - API доступен по адресу: `http://localhost:5555`
  - Фронтенд доступен по адресу: `http://localhost:5000`
- **Обработка ошибок**: Проверяет наличие Docker, Docker Compose и прав записи в рабочую директорию.

## Тестирование API
Для тестирования API выполните:
```bash
curl -X POST http://localhost:5555/api/generate -H 'Content-Type: application/json' -d '{"text": "Привет, как дела?"}'
```

## Логи и отладка
- Просмотр логов контейнеров:
  ```bash
  docker compose logs
  ```
- Остановка контейнеров:
  ```bash
  docker compose stop
  ```
- Удаление контейнеров:
  ```bash
  docker compose down
  ```

## Примечания
- Убедитесь, что файл `docker-compose.yml` находится в рабочей директории.
- Скрипт проверяет доступность API и фронтенда после запуска контейнеров.
- Модели загружаются с Hugging Face, если отсутствуют в рабочей директории.